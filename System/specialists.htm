<!DOCTYPE html>
<html>
	<head>
		<title> panel </title>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
		<link type='text/css' rel='stylesheet' href="http://Services.web-manufacture.net/Styles/System.default.css"/>
		<script type="text/javascript" src="http://Services.web-manufacture.net/Base/v1.3/Utils.js"></script>
		<script type="text/javascript" src="http://Services.web-manufacture.net/Base/v1.3/DOM.js"></script>
		<script type="text/javascript" src="http://system.web-manufacture.net/Names.js"></script>
		
		<script type="text/javascript" src="http://system.web-manufacture.net/recursionNames.js"></script>
		
		<style>
			
			.panel{
				position: absolute;				
				background-color: #FFA;
				border: solid 1px white;
				
			}	
			
			.panel.left-panel{
				top: 0;
				left: 0;
				width: 10px;
				height: 100%;
				-moz-box-sizing: border-box;
				-webkit-box-sizing: border-box;
				box-sizing: border-box;
				float: left;	
				overflow: hidden;
			} 
			.fix{
				background-image:url('http://cdn5.iconfinder.com/data/icons/Vector-Icon-set-1-BevelAndEmboss-Net/89/pin.png');
				height:30px;
				width:30px;
				background-size:cover;	
			}
			
			#pinButton.pined{
				border-radius: 10px 10px 10px 10px;
				background-color: white;
			}
			
			.panel.left-panel.panel-pin{
				width: 600px;
			}
			
			.left-panel:hover{
				width: 600px;
			}
			
			
			
			.specialists{
				float: left;
				background-color: fuchsia;
				width: 570px;
			}
						
			.specialist{	
				background-color: white;
				border-radius: 5px 5px 5px 5px;
				border: 1px solid black;
				margin: 2px;
			}
			
			
			.specialist:hover{
				border-radius: 5px 0px 0px 5px;
				border-right: 2px solid white;
			}			
			
			.prototype{
				display: none;	
			}
			
			.tabs-field{
				width: 20px;
				height: 100%;
				border-right: 1px solid navy;
				float: left;
			}
			
			.tab-container{
				width: 19px;
				height: 60px;
				background-color: purple;
				border-radius: 10px 0px 0px 10px;
				border: 1px solid black;
				border-right: none;
				cursor: pointer;
				color: white;
			}
			
			.tab-container:hover{
				background-color: #ff00ff;
			}
			
			.tab-container:active{
				background-color: silver;
			}
			
			.tab-container.selected{
				background-color: fuchsia;
				font-weight: bold;
				color: black;
				width: 21px;
			}
			
			.name-tab{
				-moz-user-select: none;
				-webkit-user-select: none;
				-moz-transform: rotate(270deg);
				-webkit-transform: rotate(270deg);
				width: 55px;
				height: 19px;
				position: relative;	
				text-align: center;
				left: -18px;
				top: 20px;	
			}			
			.org-pattern,
			.org-name,
			.org-address,
			.org-town,
			.speciality,
			.index,
			.full-name,
			.telephone,
			.e-mail,
			.diagram
			{
				
				margin: 2px;
				padding: 2px;
			}
			
			.org-pattern{
				float:left;
				background-color:#CD853F;
				-moz-box-shadow: 1px 1px 1px #838B8B;
				-webkit-box-shadow: 1px 1px 1px #838B8B;
				box-shadow: 1px 1px 1px #838B8B;
				font-weight: bold;
				color: white;
			}
			
			.org-name{
				color: #8B4726;
				font-weight: bold;
				float:left;
				
			}
			.org-town,
			.org-address{
				float:left;
			}
			.speciality{
				clear:left;float:left;
				background-color: #98F5FF;
				-moz-box-shadow: 1px 1px 1px #838B8B;
				-webkit-box-shadow: 1px 1px 1px #838B8B;
				box-shadow: 1px 1px 1px #838B8B;
				
			}
			.specialist .index{
				float:left;
				background-color:#00C5CD;
				-moz-box-shadow: 1px 1px 1px #838B8B;
				-webkit-box-shadow: 1px 1px 1px #838B8B;
				box-shadow: 1px 1px 1px #838B8B;
				font-weight: bold;
				color: white;
			}
			
			.full-name{
				font-size: 20px;
				font-weight: bold;
			}
			.full-name,
			.telephone,
			.e-mail{
				float:left;
			}
			.org-town,
			.org-address{	
				color:white;
				background-color: #CDC9C9;
			}
			
			.telephone,
			.e-mail{
				color: #CDC9C9;
			}
			.telPic,
			.mailPic{
				float:left;
				height:20px;
				width:20px;
				background-size:cover;
			}
			.telPic{
				background-image:url('http://cdn4.iconfinder.com/data/icons/openPhone_by_Walrick/PNG/128/Phone.png');
			}
			.mailPic{
				background-image:url('http://cdn4.iconfinder.com/data/icons/redux/Icons/Mail.png');
			}
			.diagram{
				clear:left;
			}
			
		</style>
		
		<script>
			
			/*
WebDb = WebDB = {
DB : [],

init : function(){
var names = ["abrams", "John", "Vasya", "Petya", "Ira", "Kolya", "Sema", "Suxx", "James", "Alex"];
for (var i = 0; i < 100; i++){
var rec = { name : names[Math.round(Math.random(10))]};
rec.title = rec.name + " " + i;
rec._id = "spec" + i;
rec.class = "specialist";
rec.orgId = "org" + Math.round(Math.random(10));
WebDb.DB[i] = rec;
}
},

_getData : function(){
for (var i = 0; i <= 100000; i++){
var body = DOM("body");	
}
return WebDb.DB;
},

get: function (selector, callback){		
window.setTimeout(function(){
callback(WebDb.DB);
}, 1000);
},

add: function (value, callback){
return '2';
},
set: function (selector, value, callback){
return '3';
},
del: function (selector, callback){
return '4';
},
};

WebDb.init();



var a = WebDb.get('', null);
alert('' + a);
*/
			
			
			
			function Init() {
				var sNames=FullNames;
				var nameTabs = DOM.get(".tabs-field");
				var proto = DOM(".tab-container.prototype");
				var counter=10;
				var spec=TabIndexer.GetSource(sNames, counter);
				console.log(spec);
				for (var s in spec){
					var tab_proto = proto.clone();
					tab_proto.MyIndexes=[spec[s][0], spec[s][1]];
					//var smth=spec[s][1];
					console.log(s);
					tab_proto.all(".name-tab").set(null, s);
					nameTabs.add(tab_proto);
				}
				
				
			};
			
			WS.DOMload(Init);
			
			/*

И еще, ребят, давайте учится культурной речи! :)
В JS не принято вообще пользоватся 
function tabIndexer() такой формой в крупных проектах (а у нас он крупный! порядка 10 модулей только в нашем случае!)

когда так объявляешь то ф-я объявляется в window. А в window и так всегда порядка 1000 переменных!

поэтому используют так называемые Frame-объекты или Namespaces

Делается это так:

LeftPanel = {}

LeftPanel.Init = function(){
...
var src = TabIndexer.GetTabsSource(Names);
...
}

Данный пример о левой панели, но!
Этот вызов предполагает что 

TabIndexer.GetTabsSource(Names)

Ф-я GetTabsSource также находится в своем объекте TabIndexer.

*/
			
			function fix(){
				var lPan = DOM.get("#SpecialistPanel");
				var pin = DOM.get("#pinButton");
				if (lPan.is('.panel-pin')){
					pin.del('.pined');
					lPan.del('.panel-pin'); 
				} else {
					pin.add('.pined');
					lPan.add('.panel-pin');
				};
			};
			
			function makeTabSelected(a){
				var allTabs = DOM.all('.tab-container');
				allTabs.del('.selected');
				a.add('.selected');
				showSelectedSpecs(a);
			};  
			
			function showSelectedSpecs(tab){
				var spcDiv = DOM.get(".specialists");
				var proto = DOM(".specialist.prototype");
				var sNames=FullNames;				
				spcDiv.all(".specialist").del();
				var ind2= tab.MyIndexes[1];
				for (ind1=tab.MyIndexes[0]; ind1 < tab.MyIndexes[1]; ind1++){
					var spec_proto = proto.clone();					
					spec_proto.all(".full-name").set(null, sNames[ind1]);	
					spcDiv.add(spec_proto);				
				}				
			};
			
			function showInfo(){
				var shortI = DOM.get(".shortInfo");
				var fullI = DOM.get(".fullInfo");
				if (shortI.is('.unfixed')){
					shortI.del('.unfixed');
					fullI.del('.fixed'); 
				} else {
					shortI.add('.unfixed');
					fullI.add('.fixed');
				}
			};
			
		</script>
	</head>
	<body>
		<include url='http://services.web-manufacture.net/UI/Dragging.htm'></include>
		<!--include url='http://services.web-manufacture.net/Authentication/Authentication.htm'></include-->
		<div id='SpecialistPanel' class="panel left-panel hidden-panel">
			<div title="Fix" id='pinButton' class="fix" onclick= "fix()"></div>
			<div class="tabs-field">
				
				<div class='tab-container prototype' onclick= 'makeTabSelected(this)' display='block'>
					<div class='name-tab'>
						Таб
					</div>
				</div>	
				
			</div>
			<div class="specialists">
				
			</div>
		</div>
		<div class="specialist prototype small-plate" onclick='showInfo()'>
				<div class='org-pattern' field='org-pattern'>
					ОП 
				</div>
				<div class='org-name' field='org-name'>
					"Засада", особое отделение №666
				</div>
				<div class='org-address' field='org-address'>
					ул.Светлая, 27
				</div>
				<div class='org-town' field='org-town'>
					пгт Бобруйск
				</div>
				
				<div class='speciality' field='speciality'>
					Техник по племенному делу
				</div>
				<div class='index addition-info' field='index'>
					A95
				</div>
				<div class='full-name' field='full-name'>
					Иванов Иван Петрович
				</div>
				<div class='telephone addition-info' field='telephone'>
					<div class='telPic'></div>
					063-777-77-77
				</div>
				<div class='e-mail addition-info' field='e-mail'>
					<div class='mailPic'></div>
					ivanov@mail.ru
				</div>
				<div class='diagram addition-info' field='diagram'>
					bla-bla-bla
				</div>
		</div>
		
	</body>
</html>
