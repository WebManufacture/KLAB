<!DOCTYPE html>
<html>
    <head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
	<script type="text/javascript" src="system.js.js" key="jss"></script>
	<script type="text/javascript" src="system.utils.js" key="jss"></script>
	<script type="text/javascript" src="system.jasp.js" key="jss"></script>
	<script type="text/javascript" src="system.ajax.js" key="jss"></script>
	<script type="text/javascript" src="system.modules.js" key="jss"></script>
	<link type='text/css' rel='stylesheet' href="System.default.css"/>
	<title>Стикеры</title>
    </head>
    <body>
	<h2>Двойной щелчек добавит стикер</h2>
	<a onclick="//window.sidebar.addPanel(this.attr('title'), this.attr('href'), ''); //return false;" rel='sidebar' href="javascript:DFCTech_WEB_Favelets={file: 'module.stickers.htm'}; DFCTech_WEB_Favelets.Process = function(){ var file = DFCTech_WEB_Favelets.file; window.DFCTech_WEB_ServerRoot = 'http://system.web-manufacture.net/'; document.head = document.getElementsByTagName('head'); document.head = document.head[0]; var link = document.createElement('link'); link.setAttribute('rel', 'stylesheet'); link.setAttribute('href', window.DFCTech_WEB_ServerRoot + 'system.common.css'); document.head.appendChild(link); if (window.W == undefined || !window.W.IsOlmObject) { DFCTech_WEB_Favelets.CreateScript('system.js.js', DFCTech_WEB_Favelets.ContinueLoad); } else { DFCTech_WEB_Favelets.ContinueLoad(); }; }; DFCTech_WEB_Favelets.LoadModule = function(){ M.LoadModule(DFCTech_WEB_Favelets.file, null, 'favelets'); }; DFCTech_WEB_Favelets.CreateScript = function(url, onload){ var script = document.createElement('script'); script.setAttribute('type', 'text/javascript'); script.setAttribute('src', window.DFCTech_WEB_ServerRoot + url); script.onload = onload; document.head.appendChild(script); return script; }; DFCTech_WEB_Favelets.ContinueLoad = function(){ if (window.J == undefined || !window.J.IsOlmObject) { DFCTech_WEB_Favelets.CreateScript('system.jasp.js'); }; if (window.X == undefined || !window.X.IsOlmObject) { DFCTech_WEB_Favelets.CreateScript('system.ajax.js'); }; if (window.M == undefined || !window.M.IsOlmObject) { DFCTech_WEB_Favelets.CreateScript('system.modules.js', DFCTech_WEB_Favelets.LoadModule); } else { DFCTech_WEB_Favelets.LoadModule(); }; }; DFCTech_WEB_Favelets.Process(); void(0);"
	title="Стикеры (Букмарклет)">Чтобы использовать стикеры на других сайтах, кликните сюда. (добавить ссылку в избранные)</a>
    <include url="module.stickers.htm" onreg="Loaded();"></include>
    
    <div class="tool-area">
	<div class="iarea area" style="background: none;">
	    Здесь стикеры становятся важными
	</div>
	
	
	<div class="del area" style="background: url('Images/delete.png');">
	</div>
	
	<div class="garea area" style="background: green;">
	</div>
	
	<div class="yarea area" style="background: yellow;">
	</div>
	
	<div class="barea area" style="background: blue;">
	</div>
	
    </div>
	
	
	<div class="proto-area">
	    <div class="sticker proto green">
		
	    </div>
	    
	    <div class="sticker proto yellow">
		
	    </div>
	    	    
	    <div class="sticker proto blue">
		
	    </div>
	    
	      
	    <div class="sticker transparent resizable proto">
		
	    </div>
	</div>
    
    <script type="text/javascript">
	
	Init = function(){
	    W.Body.ondblclick = CreateSticker;
	};
	
	function CreateSticker(event){
	    var sticker = Stickers.Create(W.Body);
	    sticker.style.top = event.clientY + "px";
	    sticker.style.left = event.clientX + "px"; 
	    event.stopPropagation();
	    event.preventDefault();
	    return true;
	}
	
	Loaded = function(){
	    window.iarea = W.Body.get(".iarea");
	    Drag.MakeReceiver(iarea, ".sticker");
	    iarea.objectReceived = IAreaObj;
	    
	    window.darea = W.Body.get(".del.area");
	    Drag.MakeReceiver(darea, ".sticker");
	    darea.objectReceived = DAreaObj;
	    
	    
	    window.garea = W.Body.get(".garea");
	    Drag.MakeReceiver(garea, ".sticker");
	    garea.objectReceived = GAreaObj;
	    
	    window.yarea = W.Body.get(".yarea");
	    Drag.MakeReceiver(yarea, ".sticker");
	    yarea.objectReceived = YAreaObj;
	    
	    window.barea = W.Body.get(".barea");
	    Drag.MakeReceiver(barea, ".sticker");
	    barea.objectReceived = BAreaObj;

	    var proto = W.findAll(".sticker.proto");
	    for (var i = 0; i < proto.length; i++){
		proto[i].onClone = CloneProto;
		Drag.MakeDraggable(proto[i], "clone");
	    }
	};
	
	CloneProto = function(clone){
	    Stickers.InitSticker(clone);
	    clone.rcs("proto");
	};
	
	IAreaObj = function(obj){
	    obj.toggle("important");
	    return false;
	};
	
	DAreaObj = function(obj){
	    Stickers.Del(obj);
	    return false;
	};
	
	GAreaObj = function(obj){
	    Stickers.SetStyle(obj, "green");
	    return false;
	};
	
	BAreaObj = function(obj){
	    Stickers.SetStyle(obj, "blue");
	    return false;
	};
	
	YAreaObj = function(obj){
	    Stickers.SetStyle(obj, "yellow");
	    return false;
	};
	
	W.OnLoad(Init);
    </script>
    
    <style type="text/css">
	
	body{
	    -moz-user-select: none;
	}
	
	.tool-area{
	    width: 140px;
	    float: left;
	}
	
	.tool-area .area{
	    width: 128px;
	    height: 128px;
	    margin: 10px;
	    opacity: 0.5;
	}
	
	.tool-area .area.dragover{
	    opacity: 1;
	    border: dotted 1px gray;
	}
	
	.proto-area
	{
	    width: 128px;
	    height: 390px;
	    margin: 10px;
	    float: right;	    
	}
	
	.proto-area .sticker
	{
	    position: static;
	}
	
    </style>
    
</body>
</html>