<!DOCTYPE html>
<html>
	<head>
		<title> TabsDB </title>
		<meta content="text/html; charset=utf-8" http-equiv="Content-Type">
		<link type='text/css' rel='stylesheet' href="http://Services.web-manufacture.net/Styles/System.default.css"/>
		
		<script type="text/javascript" src="http://Services.web-manufacture.net/Base/v1.3/Utils.js"></script>
		<script type="text/javascript" src="http://Services.web-manufacture.net/Base/v1.3/DOM.js"></script>
		<script type="text/javascript" src="http://Services.web-manufacture.net/Base/v1.3/NodeTunnel.js"></script>
		<script type="text/javascript" src="http://Services.web-manufacture.net/Base/v1.3/Url.js"></script>
		<style>
			
			.clear{
				clear: both;	
			}
			
			
			#specialists{
				float: left;
				background-color: #FF893B;
				width: auto;
				min-width: 500px;
				position:relative;
				
			}
			
			.lightbox.show{
				background-color: silver;
				display: inline-block;
				height: 100%;
				opacity: 0.8;
				position: absolute;
				width: 100%;
		
			}
			
			#specialists .specialist,
			#specialists .newSpec{	
				background-color: white;
				border-radius: 5px 5px 5px 5px;
				border: 1px solid black;
				margin: 2px;
			}
			
			
			#specialists .specialist:hover{
				background-color: #FFE886;
			}			
			
			
			#tabs-panel{
				width: 20px;
				height: 100%;
				border-right: 1px solid navy;
				float: left;
			}
			
			#tabs-panel .tab-container{
				width: 19px;
				height: 60px;
				background-color: #FFCA53;
				border-radius: 10px 0px 0px 10px;
				border: 1px solid black;
				border-right: none;
				cursor: pointer;
				color: black;
				
			}
			
			#tabs-panel .tab-container:hover{
				background-color: #FF893B;
			}
			
			#tabs-panel .tab-container:active{
				background-color: silver;
			}
			
			#tabs-panel .tab-container.selected{
				background-color: #FF893B;
				font-weight: bold;
				color: black;
				width: 21px;
			}
			
			#tabs-panel .name-tab{
				-moz-user-select: none;
				-webkit-user-select: none;
				-moz-transform: rotate(270deg);
				-webkit-transform: rotate(270deg);
				width: 55px;
				height: 19px;
				position: relative;	
				text-align: center;
				left: -18px;
				top: 20px;
				
			}
			
			.addSpecBut{
				background-image:url('http://cdn2.iconfinder.com/data/icons/onebit/PNG/onebit_31.png');
				height:22px;
				width:22px;
				background-size:cover;
				cursor: pointer;
			}
			
			
			.specialist.small-plate .additional-info{
				display: none;
			}
			
			.spec-field
			{
				display: inline-block;
				margin: 2px;
				padding: 2px;
			}
			
			.spec-pattern
			{
				display: inline-block;
				width: 80px;
				margin-right: 2px;
				margin-left: 5px;
			}
			
			.spec-pattern .spec-field
			{
				margin: -15px 0;
				max-width: 70px;
				overflow: hidden;
				position: absolute;
				white-space: nowrap;
				/*margin-top: 0;				
				max-width: 70px;
				overflow: hidden;
				margin: 0 0 -5px 0;/*убрала нижний отступ*/
				/*white-space: nowrap;
				height: 15px;*/
			}
			
			.org-pattern{
				background-color:#42786B;
				-moz-box-shadow: 1px 1px 1px #838B8B;
				-webkit-box-shadow: 1px 1px 1px #838B8B;
				box-shadow: 1px 1px 1px #838B8B;
				font-weight: bold;
				color: white;
			}
			
			.specialist .org-name{
				color: #6B121A;
				font-weight: bold;
				
			}
			

			.specialist .speciality{
				background-color: #FF653E;
				-moz-box-shadow: 1px 1px 1px #838B8B;
				-webkit-box-shadow: 1px 1px 1px #838B8B;
				box-shadow: 1px 1px 1px #838B8B;
				color: white;
				
			}
			.specialist .spec-pattern .speciality:hover{
				overflow: visible;
				max-width: 500px;
				position: absolute;
			}
			
			.specialist .index{
				background-color:#71CCB6;
				-moz-box-shadow: 1px 1px 1px #838B8B;
				-webkit-box-shadow: 1px 1px 1px #838B8B;
				box-shadow: 1px 1px 1px #838B8B;
				font-weight: bold;
				color: white;
			}
			
			.specialist .full-name{
				font-size: 20px;
				font-weight: bold;
			}
			
			.specialist .org-town,
			.specialist .org-address{	
				color:white;
				background-color: #71CCB6;
			}
			
			.specialist .telephone,
			.specialist .e-mail{
				color: #70A188;					
			}
			
			.specialist .telephone .field,
			.specialist .e-mail .field{
				display: inline-block;	
			}
			
			.specialist .field-pic{
				height:20px;
				width:20px;
				background-size:cover; 
				margin: 0 0 -5px 0;/*убрала нижний отступ*/
				display: inline-block;
			}
			
			.specialist .ShowHideSmallPlate.hide{
				background-image:url('http://cdn1.iconfinder.com/data/icons/CrystalClear/128x128/apps/package.png');
			}
			
			.specialist .ShowHideSmallPlate{
				float: right;
				margin: 3px 3px 0 0;
				background-image:url('http://cdn1.iconfinder.com/data/icons/nuvola2/128x128/apps/package.png');
			}


			.specialist .editSpecsBut{
				display: none;
				float: right;
				margin: 3px 3px 0 0;
				background-image:url('http://cdn3.iconfinder.com/data/icons/prettyoffice/128/edit.png');
			}
			
			.specialist:hover .editSpecsBut{
				display: inline-block;
			}
			
			.specialist .telPic{
				background-image:url('http://cdn3.iconfinder.com/data/icons/token/Token,%20128x128,%20PNG/Telephone.png');
				
			}
			
			.specialist .mailPic{
				background-image:url('http://cdn3.iconfinder.com/data/icons/token/Token,%20128x128,%20PNG/Envelope.png');
			}
			
			.newSpec.hideDiv{
				display:none;
			}
			
			#specialists .newSpec{
				background-color: #FFE886;
				
				width: auto;
				height: 200px;
			}
			

			.newSpec .addInfo{
				display: inline-block;
				vertical-align: top;
				/*margin-left: 5px;
				margin-right: 2px;*/
				margin: 5px;
				
				
			}
			
			.newSpec .buttons{
				text-align:center;
			}
			
			.newSpec .input{
				text-align:center;
				height:20px;
				margin: 5px;
			}
			.newSpec .input.Name{
				background-color:#D0F18F;
				width: 100%;
			}
			.newSpec .input.Tel,
			.newSpec .input.Mail,
			.newSpec .org-info{
				width: 100%;
			}
			/*http://kuler.adobe.com/#themeID/2046286*/
			
			
			.newSpec .input.empty{
				color: #8B8989;	
			}

			.newSpec .selectOffice{
				display: inline-block;
			}
			.newSpec .scroll_child{
				width:200px;
				height:70%;
				overflow-x:hidden;
				overflow-y:scroll;
				background-color: white;
				cursor: pointer;
				font-size: 12px;
				white-space: nowrap;

			}
			.newSpec .selectSpeciality:hover{
				background-color: #D0F18F;
			}
		</style>
		
		<script>
			
			
			Tabs = {};
			
			Tabs.Init = function(){
				Tabs.ContentServer = new NodeTunnel('http://unimedica3.web-manufacture.net:810');
				Tabs.ContentServer.get('/', function(rt, er){
					Tabs.CreateTab(JSON.parse(rt));
				});
				
				
			};
						
			//Формеруем табы из массива Tabs.TabsName
			Tabs.CreateTab = function(TabsNames){
				var proto = DOM(".tab-container.prototype");
				var tabDiv = DOM.get("#tabs-panel");
				for (var i = 0; i<TabsNames.length; i++){
					var tabProto = proto.clone();
					tabProto.set('@tab-no', i + '');
					var tn = TabsNames[i];
					tn = tn.split('-');
					tabProto.innerHTML = "<div class='tab-val first'>"+ tn[0] + "</div><div class='tab-val last'>"+ tn[1] + "</div>";
					//var nameTab = tabProto.get('.name-tab');
					//nameTab.set(null, TabsNames[i]);
					tabDiv.add(tabProto);
				};	
			};
						
			//По клику выводим содержимое нужного таба
			Tabs.ContentDisplay = function(displayidTab){
				var tabNo = displayidTab.get('@tab-no');
				Tabs.makeTabSelected(displayidTab); //Здесь таб делаеться видемым, а содержимое других табов удаляется
				Tabs.specLightbox();
				var ContentQueryString = Request.GetUrl('http://web-manufacture.net:14211', {IndexByNameTab: '' + tabNo});
				Tabs.ContentServer.all(ContentQueryString, function(rt, er){
					var TabsName = JSON.parse(rt);
					Tabs.showSelectedSpecs(TabsName); //Здесть Создаються дивы с записями
					Tabs.specLightbox();
				});
			};
			
					
			WS.DOMload(Tabs.Init);
			
			
			
			function fix(){
				var lPan = DOM.get("#specialists");
				var pin = DOM.get("#pinButton");
				if (lPan.is('.panel-pin')){
					pin.del('.pined');
					lPan.del('.panel-pin'); 
				} else {
					pin.add('.pined');
					lPan.add('.panel-pin');
				};
			};
			
			Tabs.makeTabSelected = function(displayidTab){
				var allTabs = DOM.all('.tab-container');
				allTabs.del('.selected');
				displayidTab.add('.selected');
			};  
			
			Tabs.showSelectedSpecs = function(tab){
				var spcDiv = DOM.get("#specialists");
				var proto = DOM(".specialist.prototype");
				spcDiv.all(".specialist").del();
				for (var i = 0; i < tab.length; i++){
					var spec_proto = proto.clone();					
					spec_proto.get(".full-name").set(null, tab[i].name);
					spcDiv.add(spec_proto);				
				};				
			};
			
			Tabs.specLightbox = function(){
				var divLB= DOM.get('.lightbox')	
				if (divLB.is('.show')) divLB.del('.show');
				else divLB.add('.show');
			};
			
			
			Tabs.EditUserContent = function(e){
				//var nameDiv = e.get('^.specialist');
				//var changeName = nameDiv.get('.full-name');
				//e.title = (changeName.isContentEditable)? "включить редактирование": "отключить редактирование";
				//changeName.contentEditable =(changeName.isContentEditable)? false: true;
				//if (changeName.isContentEditable){
				//var spcDiv = e.get("^.specialist");
				//spcDiv.add('.editable');
				//changeName.add('.editable');
				//}
				
				
				
			};
			
			Tabs.showInfo = function(sh){
			
				var spcDiv = sh.get("^.specialist");
				if (spcDiv.is('.small-plate')){
					sh.del('.hide');
					spcDiv.del('.small-plate');
					
				} else {
					sh.add('.hide');
					spcDiv.add('.small-plate');
					
				}
			};
			
			function CreateNewSpec(){
				var spcDiv = DOM.get("#specialists");
				//spcDiv.all(".specialist").del();
				var srcDiv = DOM.get('.speciality.addInfo');
				var nSpec = DOM.get(".newSpec");
				
				if(nSpec.is('.hideDiv')){
					nSpec.del('.hideDiv');
				}else {
					nSpec.add('.hideDiv');
				}
				
				 
				//var newDiv = DOM.div(".newSpec");
				//newDiv.SpecJob = newDiv.div(".speciality.scroll_child");
				//newDiv.SpecElem = newDiv.div(".org-info");
				//newDiv.AddInfo = newDiv.div(".addInfo");
				//newDiv.SpecName = AddInfo.div(".input.Name");
				//newDiv.SpecTel = AddInfo.div(".input.Tel");
				//newDiv.SpecMail = AddInfo.div(".input.Mail");
				//return newDiv;
		
	    		var spcDiv = DOM.get(".newSpec .prototype");
				var proto = DOM(".selectSpeciality.prototype");
				var sSpec=FullSpecialities;
				var l=sSpec.length-1;					
				for (var i=0; i<=l; i++){
					var sSpec_proto = proto.clone();					
					//sSpec_proto.all(".speciality.addInfo .selectSpeciality").set(null, sSpec[i]);
					//srcDiv.add(sSpec_proto);
					sSpec_proto.set(null, sSpec[i]);
					srcDiv.add(sSpec_proto);
					
				}
				InputWDT.Init();
			};
			
			
			InputWDT = {
				Init : function(){
					DOM.all("input[default-text]").each(function(elem){
						elem.onfocus = InputWDT.InputFocused;
						elem.onblur = InputWDT.InputBlur;
						InputWDT.InitInput(elem);
					});
				},
				
				InitInput : function(elem){
					if(!elem.value || elem.value==elem.get('@default-text')){
						elem.add('.empty');
						elem.value = elem.get('@default-text');
					}
				},
				
				InputFocused : function(){
					if(this.is('.empty')){
						this.del('.empty');
						this.value='';
					}
				},
				
				InputBlur : function(){
					if(!this.value){
						this.add('.empty');
						this.value=this.get('@default-text');
					}
				},
				
				
			}
				
				//	Tab.SetInfo = function(){
					
				//};
				
		</script>
	</head>
	<body>
		
		<script type="text/javascript" src="http://system.web-manufacture.net/Names.js"></script>		
		<script type="text/javascript" src="http://system.web-manufacture.net/recursionNames.js"></script>
		<script type="text/javascript" src="http://system.web-manufacture.net/Specialities.js"></script>
		<include url='http://services.web-manufacture.net/UI/Dragging.htm'></include>
		<include url='http://services.web-manufacture.net/UI/HtmlElements.htm'></include>
		<include url='http://system.web-manufacture.net/UI/SpecialistsDB.htm'></include>
		<!--include url='http://services.web-manufacture.net/Authentication/Authentication.htm'></include-->
		
		<div class='addSpecBut' title="Add new specialist" id='addSpecBut' onclick="CreateNewSpec()">	</div>
		<div id="tabs-panel">
			
			<div class='tab-container prototype' onclick= 'Tabs.ContentDisplay(this)' display='block'>
				
				<div class='name-tab'>
					Таб
				</div>
			</div>	
			
		</div>
<div id="specialists">
			<div class='lightbox'></div>
			<div class='newSpec hideDiv'>
				<!--<input type="submit" value="Submit" />-->
				<div class="speciality  addInfo scroll_child" size="1">
					<div class='selectSpeciality prototype'> Выбрать профессию </div>
				</div>
				<div class='addInfo'>
				<select class="org-info " size="1" >
					<option class='selectOffice '> Выбрать контору и тип конторы </option>
				</select>
					<br/>
				<input class="input Name " default-text="ФИО">
					<br/>
				<input class="input Tel " default-text="telephone">
					<br/>
				<input class="input Mail " default-text="e-mail">
				</div>
				<div class='buttons'>
					<div class='btn-ira ok ' title='OK'> OK </div>
					<div class='btn-ira clear ' title='Clear'> Clear </div>
					<div class='btn-ira cancel ' title='Cancel'> Cancel </div>
				</div>
				
			</div>						
		</div>
		
		<div class="specialist prototype small-plate" onclick='showInfo(this)'>
			
			<div class='spec-field spec-pattern'>
				<div class='org-pattern spec-field field' field='org-pattern'>
					ОП 
				</div>
			</div>
			
			<div class='org-name spec-field field' field='org-name'>
				"Засада", особое отделение №666
			</div>
			<div class='org-address spec-field field additional-info' field='org-address'>
				ул.Светлая, 27
			</div>
			<div class='org-town spec-field field additional-info' field='org-town'>
				пгт Бобруйск
			</div>
			<div class='ShowHideSmallPlate hide field-pic field' title='Show/Hide' onclick='Tabs.showInfo(this)'></div>
			<br/>

			<div class='spec-pattern  spec-field'>
				<div class='speciality spec-field field' field='speciality'>
					Техник по племенному делу
				</div>
			</div>
			<div class='index field spec-field additional-info' field='index'>
				A95
			</div>
			<div class='full-name spec-field field' field='full-name'>
				Иванов Иван Петрович
			</div>
			<div class='editSpecsBut field-pic field' title='Edit Specialist&aposs info' onclick='Tabs.EditUserContent(this)'></div>
			<br/>
			<div class='additional-info'>
				<div class='telephone spec-field'>
					<div class='telPic field-pic'></div>
					<div class='telephone field'  field='telephone'>063-777-77-77</div>
				</div>
				<div class='e-mail spec-field'>
					<div class='mailPic field-pic'></div>
					<div class='e-mail field' field='e-mail'>ivanov@mail.ru</div>
				</div>
				<br/>
				<div class='diagram  spec-field field' field='diagram'>
					bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla-bla
				</div>
			</div>
		</div>
		
		
		
	</body>
</html>
